#!/bin/bash

# ç®€å•çš„æ•°æ®åº“è¿ç§»è„šæœ¬
# ç”¨æ³•: bash migrations/run-migration-simple.sh

echo "=========================================================="
echo "ğŸš€ å¼€å§‹æ‰§è¡Œæ•°æ®åº“è¿ç§»"
echo "=========================================================="
echo "ğŸ“„ è¿ç§»æ–‡ä»¶: 001_add_organization_to_projects.sql"
echo "â° å¼€å§‹æ—¶é—´: $(date)"
echo ""

# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
if [ ! -f "migrations/001_add_organization_to_projects.sql" ]; then
    echo "âŒ é”™è¯¯: è¿ç§»æ–‡ä»¶ä¸å­˜åœ¨"
    exit 1
fi

echo "ğŸ“Š å‡†å¤‡æ‰§è¡Œè¿ç§»..."
echo ""

# æ‰§è¡Œè¿ç§»
psql -h localhost -U postgres -d blueprint_saas -f migrations/001_add_organization_to_projects.sql

if [ $? -eq 0 ]; then
    echo ""
    echo "=========================================================="
    echo "ğŸ‰ è¿ç§»æˆåŠŸå®Œæˆï¼"
    echo "=========================================================="
    echo "â° å®Œæˆæ—¶é—´: $(date)"
else
    echo ""
    echo "=========================================================="
    echo "âŒ è¿ç§»å¤±è´¥"
    echo "=========================================================="
    echo "ğŸ’¡ å»ºè®®:"
    echo "1. æ£€æŸ¥æ•°æ®åº“è¿æ¥"
    echo "2. éªŒè¯ SQL è¯­æ³•"
    echo "3. æ£€æŸ¥æ•°æ®å®Œæ•´æ€§"
    exit 1
fi
