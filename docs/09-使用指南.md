# 📖 蓝图 AI 使用指南

## 🎯 项目概述

蓝图 AI 是一个**系统架构梳理和建模工具**，帮助你：
- 梳理复杂系统的功能模块
- 定义数据实体和属性
- 建立实体之间的关系
- 使用 AI 辅助分析
- 可视化系统架构
- 对比不同系统的差异

---

## 🚀 快速上手

### 1. 登录系统

访问 http://localhost:3000，你会看到登录界面。

**选项 A：使用测试账户**
- 邮箱：`test@example.com`
- 密码：`123456`

**选项 B：注册新账户**
1. 点击"还没有账户？立即注册"
2. 填写姓名、邮箱、密码
3. 点击"注册"

### 2. 创建第一个项目

登录后，你会看到"项目管理中心"：

1. 点击 **"+ 创建新项目"** 按钮
2. 输入项目名称（如："电商系统"）
3. 输入项目描述（可选）
4. 点击"创建"

---

## 📊 核心功能详解

### 一、项目管理

#### 项目列表
- **查看项目**：显示所有项目卡片
- **搜索项目**：使用搜索框快速查找
- **筛选项目**：切换"活跃项目"和"已归档"
- **项目操作**：
  - 📝 选择项目进入编辑
  - 📦 归档/取消归档
  - 🗑️ 删除项目
  - 📤 导出为 Excel
  - 📥 导入项目数据

#### 导入备份数据
1. 点击顶部的 **"导入备份"** 按钮
2. 选择 JSON 格式的备份文件
3. 点击"开始导入"
4. 系统会自动导入所有项目

---

### 二、功能模块管理

选择项目后，点击左侧 **"功能模块"** 进入模块编辑器。

#### 创建模块层级

**模块结构示例：**
```
电商系统
├── 用户管理
│   ├── 用户注册
│   ├── 用户登录
│   └── 个人中心
├── 商品管理
│   ├── 商品列表
│   ├── 商品详情
│   └── 商品搜索
└── 订单管理
    ├── 创建订单
    ├── 订单支付
    └── 订单查询
```

#### 操作步骤

1. **添加顶级模块**
   - 点击 "➕ 添加模块"
   - 输入模块名称（如："用户管理"）
   - 输入描述（可选）

2. **添加子模块**
   - 点击父模块的 "➕ 添加子模块"
   - 输入子模块名称

3. **添加功能点**
   - 在模块下点击 "➕ 添加功能点"
   - 输入功能点名称（如："用户注册"）
   - 输入功能描述
   - 关联实体（可选）
   - 上传功能截图（可选）

4. **编辑/删除**
   - 点击 ✏️ 编辑模块/功能点
   - 点击 🗑️ 删除

---

### 三、数据实体管理

点击左侧 **"数据实体"** 进入实体编辑器。

#### 创建实体

**实体示例：用户（User）**

1. **添加实体**
   - 点击 "➕ 添加实体"
   - 输入实体名称："用户"
   - 输入描述："系统用户信息"

2. **添加属性**
   
   | 属性名 | 类型 | 类别 | 必填 | 唯一 | 说明 |
   |--------|------|------|------|------|------|
   | id | String | 系统属性 | ✓ | ✓ | 用户ID |
   | username | String | 基础属性 | ✓ | ✓ | 用户名 |
   | email | String | 基础属性 | ✓ | ✓ | 邮箱 |
   | phone | String | 基础属性 | | | 手机号 |
   | status | Enum | 状态属性 | ✓ | | 用户状态 |
   | createdAt | DateTime | 系统属性 | ✓ | | 创建时间 |

3. **属性类别说明**
   - **基础属性**：实体的基本信息
   - **关联属性**：与其他实体的关联
   - **状态属性**：表示状态的属性
   - **派生属性**：由其他属性计算得出
   - **系统属性**：系统自动维护
   - **配置属性**：配置相关的属性

#### 建立实体关系

**示例：订单关联用户**

1. 在"订单"实体中添加属性 `userId`
2. 勾选 **"是关联属性"**
3. 点击 "➕ 添加关联"
4. 选择：
   - **关联类型**：Realtime（实时）
   - **基数**：N:1（多对一）
   - **关联实体**：用户
   - **关联属性**：id

**关联类型说明：**
- **Realtime**：实时关联，数据同步更新
- **Snapshot**：快照关联，保存历史数据
- **Async**：异步关联，延迟同步
- **InitialEditable**：初始可编辑，后续只读

**基数说明：**
- **1:1**：一对一（如：用户-用户详情）
- **1:N**：一对多（如：用户-订单）
- **N:1**：多对一（如：订单-用户）
- **N:M**：多对多（如：学生-课程）

---

### 四、可视化图谱

#### 系统图谱

点击左侧 **"系统图谱"** 查看实体关系图。

**功能：**
- 🔍 **缩放**：鼠标滚轮
- 🖱️ **拖动**：拖动节点调整位置
- 🎯 **选择**：点击节点查看详情
- 🔗 **关系线**：显示实体间的关联
- 📊 **图例**：右上角显示关系类型

**操作技巧：**
- 双击节点：固定/取消固定位置
- 点击关系线：查看关联详情
- 使用搜索框：快速定位实体

#### 功能图谱

点击左侧 **"功能图谱"** 查看功能模块树。

**功能：**
- 📂 展开/折叠模块
- 🎯 点击功能点查看详情
- 🔗 查看功能点关联的实体

---

### 五、AI 辅助分析

#### 配置 AI 模型

1. 点击右上角 **"设置"** 图标
2. 选择 AI 模型（如：Gemini 3 Pro）
3. 输入对应的 API Key
4. 点击"保存"

**支持的 AI 模型：**
- Google Gemini（3 Pro / 3 Flash / Lite）
- OpenAI GPT-4o
- xAI Grok-2
- DeepSeek V3
- 字节豆包 Pro
- 阿里通义千问 Max

#### 使用 AI 分析

1. 点击顶部的 **"✨ AI 分析"** 按钮
2. 在对话框中输入需求，例如：
   ```
   帮我分析一个电商系统，需要包含：
   - 用户管理模块
   - 商品管理模块
   - 订单管理模块
   - 支付管理模块
   ```
3. AI 会生成建议的模块和实体结构
4. 点击 **"应用到当前模型"** 将结果应用到项目

#### 图片分析

1. 点击 **"📷 图片分析"**
2. 上传系统截图或架构图
3. AI 会识别图片中的功能和实体
4. 审核后应用到项目

---

### 六、差异分析

用于对比两个系统的差异，常用于：
- 系统迁移
- 版本对比
- 需求分析

#### 创建差异分析任务

1. 点击左侧 **"差异分析"**
2. 点击 **"+ 创建新任务"**
3. 选择：
   - **源系统**：原系统
   - **目标系统**：新系统
4. 点击"开始分析"

#### 查看分析结果

**差异类型：**
- ✅ **一致**：两个系统中相同的实体/属性
- ⚠️ **冲突**：存在但定义不同
- ❌ **缺失**：目标系统中缺少
- ➕ **新增**：目标系统中新增

**导出报告：**
- 点击 **"导出 Excel"** 生成差异报告
- 包含实体对照表和枚举对照表

---

### 七、任务中心

点击左侧 **"任务中心"** 查看所有 AI 分析任务。

**任务状态：**
- 🔄 **分析中**：AI 正在处理
- ⏸️ **已暂停**：任务暂停
- ✅ **已完成**：分析完成
- ❌ **失败**：分析失败

**操作：**
- 👁️ 查看任务详情
- 💬 继续对话
- 📋 应用结果
- 🗑️ 删除任务

---

## 🎨 使用场景

### 场景 1：新系统设计

**步骤：**
1. 创建项目："新零售系统"
2. 使用 AI 分析生成初始架构
3. 手动调整和完善模块
4. 定义数据实体和关系
5. 导出 Excel 文档给团队

### 场景 2：系统迁移

**步骤：**
1. 导入旧系统备份数据
2. 创建新系统项目
3. 使用差异分析对比两个系统
4. 根据差异报告制定迁移计划
5. 导出迁移文档

### 场景 3：需求梳理

**步骤：**
1. 上传需求文档截图
2. AI 识别功能模块
3. 手动补充功能点
4. 定义相关实体
5. 生成可视化图谱给客户

### 场景 4：团队协作

**步骤：**
1. 每个成员注册账户
2. 导入共同的项目模板
3. 各自负责不同模块
4. 定期导出合并
5. 使用差异分析检查一致性

---

## 💡 最佳实践

### 命名规范

**模块命名：**
- 使用业务术语
- 保持简洁明了
- 例如："用户管理"、"订单管理"

**实体命名：**
- 使用单数名词
- 首字母大写
- 例如："User"、"Order"、"Product"

**属性命名：**
- 使用驼峰命名
- 见名知意
- 例如："userId"、"createdAt"、"orderStatus"

### 模块组织

**层级建议：**
- 顶级模块：业务领域（3-8个）
- 二级模块：功能分类（每个3-5个）
- 功能点：具体功能（每个5-10个）

**示例结构：**
```
电商系统
├── 用户中心（顶级）
│   ├── 账户管理（二级）
│   │   ├── 注册（功能点）
│   │   ├── 登录（功能点）
│   │   └── 找回密码（功能点）
│   └── 个人信息（二级）
│       ├── 查看资料（功能点）
│       └── 修改资料（功能点）
```

### 实体设计

**核心实体优先：**
1. 先定义核心业务实体（用户、订单、商品）
2. 再定义辅助实体（地址、评论、日志）
3. 最后定义配置实体（设置、参数）

**属性完整性：**
- 必填属性要标记
- 唯一属性要标记
- 枚举值要列出
- 关联关系要明确

### 数据导出

**定期备份：**
- 每周导出项目数据
- 保存为 JSON 格式
- 存储在安全位置

**文档生成：**
- 导出 Excel 给团队
- 包含完整的实体和属性
- 包含关系图谱

---

## 🔧 快捷操作

### 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl + S` | 保存项目 |
| `Ctrl + F` | 搜索 |
| `Esc` | 关闭弹窗 |
| `Ctrl + Z` | 撤销（部分支持）|

### 快速导航

- **切换项目**：点击顶部"切换项目"
- **返回首页**：点击左上角 Logo
- **查看帮助**：点击右上角"?"图标

---

## ❓ 常见问题

### Q: 如何导入旧版本的数据？

A: 点击顶部"导入备份"按钮，选择 JSON 格式的备份文件即可。

### Q: 可以同时编辑多个项目吗？

A: 可以创建多个项目，但同时只能编辑一个。使用"切换项目"快速切换。

### Q: AI 分析需要什么？

A: 需要配置对应的 AI API Key。在设置中配置后即可使用。

### Q: 数据存储在哪里？

A: SaaS 版本数据存储在 PostgreSQL 数据库中，每个用户的数据完全隔离。

### Q: 如何分享项目给其他人？

A: 目前可以导出 JSON 或 Excel 文件分享。团队协作功能正在开发中。

### Q: 支持离线使用吗？

A: 需要网络连接访问服务器。可以使用"持久化保存"功能保存到本地。

---

## 📞 获取帮助

- 📖 查看 [完整文档](./README.md)
- 🔧 查看 [故障排查](./06-故障排查.md)
- 💬 提交 Issue
- 📧 联系支持团队

---

**祝你使用愉快！** 🎉

